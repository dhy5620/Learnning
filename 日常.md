# 问题

## Unity Jenkins打包

### 1、检查jenkins配置

​		ANDROID_HOME；GRADLE_USER_HOME

### 2、gradle打包报错

​	Execution failed for task ':launcher:mergeReleaseResources

检查文件：

​	1、launcherTemplate.gradle

```
// GENERATED BY UNITY. REMOVE THIS COMMENT TO PREVENT OVERWRITING WHEN EXPORTING AGAIN

apply plugin: 'com.android.application'

dependencies {
    implementation project(':unityLibrary')

    // 为了防止出现 Error: Cannot fit requested classes in a single dex file
    implementation 'com.android.support:multidex:1.0.3'

    implementation 'android.arch.work:work-runtime:1.0.1'

    // 为了解决一个和 guava 有关的重复引用 bug 而添加此依赖
    implementation 'com.google.guava:listenablefuture:9999.0-empty-to-avoid-conflict-with-guava'

}

android {
    compileSdkVersion **APIVERSION**
    buildToolsVersion '**BUILDTOOLS**'

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }

    defaultConfig {
        minSdkVersion **MINSDKVERSION**
        targetSdkVersion **TARGETSDKVERSION**
        applicationId '**APPLICATIONID**'
        ndk {
            abiFilters **ABIFILTERS**
        }
        versionCode **VERSIONCODE**
        versionName '**VERSIONNAME**'

        // 为了防止出现 Error: Cannot fit requested classes in a single dex file
        multiDexEnabled true
    }

    aaptOptions {
        noCompress = ['.unity3d', '.ress', '.resource', '.obb'**STREAMING_ASSETS**]
        ignoreAssetsPattern = "!.svn:!.git:!.ds_store:!*.scc:.*:!CVS:!thumbs.db:!picasa.ini:!*~"
    }**SIGN**

    lintOptions {
        abortOnError false
    }

    buildTypes {
        debug {
            minifyEnabled **MINIFY_DEBUG**
            useProguard **PROGUARD_DEBUG**
            proguardFiles getDefaultProguardFile('proguard-android.txt')**SIGNCONFIG**
            jniDebuggable true
        }
        release {
            minifyEnabled **MINIFY_RELEASE**
            useProguard **PROGUARD_RELEASE**
            proguardFiles getDefaultProguardFile('proguard-android.txt')**SIGNCONFIG**
        }
    }**PACKAGING_OPTIONS****PLAY_ASSET_PACKS****SPLITS**
**BUILT_APK_LOCATION**
    bundle {
        language {
            enableSplit = false
        }
        density {
            enableSplit = false
        }
        abi {
            enableSplit = true
        }
    }
}**SPLITS_VERSION_CODE****LAUNCHER_SOURCE_BUILD_SETUP**

// Add the following line to the bottom of the file:
apply plugin: 'com.google.gms.google-services'  // Google Play services Gradle plugin

```

​	2、baseProjectTemplate.gradle

```
// GENERATED BY UNITY. REMOVE THIS COMMENT TO PREVENT OVERWRITING WHEN EXPORTING AGAIN

allprojects {
    buildscript {
        repositories {**ARTIFACTORYREPOSITORY**
            google()
            jcenter()
            mavenCentral()
	
			// 添加项目需要依赖的远程库文件的地址，根据自身需求修改和添加
            maven { url 'xxx' }
          
        }

        dependencies {
            // If you are changing the Android Gradle Plugin version, make sure it is compatible with the Gradle version preinstalled with Unity
            // See which Gradle version is preinstalled with Unity here https://docs.unity3d.com/Manual/android-gradle-overview.html
            // See official Gradle and Android Gradle Plugin compatibility table here https://developer.android.com/studio/releases/gradle-plugin#updating-gradle
            // To specify a custom Gradle version in Unity, go do "Preferences > External Tools", uncheck "Gradle Installed with Unity (recommended)" and specify a path to a custom Gradle version
            
            classpath 'com.android.tools.build:gradle:4.0.1'
            // 对接 google 相关 sdk 需要的配置
            classpath 'com.google.gms:google-services:4.3.5'
            **BUILD_SCRIPT_DEPS**
        }
    }

    repositories {**ARTIFACTORYREPOSITORY**
        google()
        jcenter()
        flatDir {
            dirs "${project(':unityLibrary').projectDir}/libs"
        }
        mavenCentral()
        
       // 添加项目需要依赖的远程库文件的地址，根据自身需求修改和添加
       maven { url 'xxx' }
    }
}

task clean(type: Delete) {
    delete rootProject.buildDir
}


```

​	3、mainTemplate.gradle

```
// GENERATED BY UNITY. REMOVE THIS COMMENT TO PREVENT OVERWRITING WHEN EXPORTING AGAIN

apply plugin: 'com.android.library'
**APPLY_PLUGINS**

dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])

    // 添加各种依赖项，根据需求修改和添加
    implementation 'xxx'

    // 为了防止出现 Error: Cannot fit requested classes in a single dex file
    implementation 'com.android.support:multidex:1.0.3'

    implementation 'android.arch.work:work-runtime:1.0.1'

    // 为了解决一个和 guava 有关的重复引用 bug 而添加此依赖
    implementation 'com.google.guava:listenablefuture:9999.0-empty-to-avoid-conflict-with-guava'

**DEPS**}

android {
    compileSdkVersion **APIVERSION**
    buildToolsVersion '**BUILDTOOLS**'

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }

    defaultConfig {
        minSdkVersion **MINSDKVERSION**
        targetSdkVersion **TARGETSDKVERSION**
        ndk {
            abiFilters **ABIFILTERS**
        }
        versionCode **VERSIONCODE**
        versionName '**VERSIONNAME**'
        consumerProguardFiles 'proguard-unity.txt'**USER_PROGUARD**

        // 为了防止出现 Error: Cannot fit requested classes in a single dex file
        multiDexEnabled true
    }

    lintOptions {
        abortOnError false
    }

    aaptOptions {
        ignoreAssetsPattern = "!.svn:!.git:!.ds_store:!*.scc:.*:!CVS:!thumbs.db:!picasa.ini:!*~"
    }**PACKAGING_OPTIONS**
}**REPOSITORIES****SOURCE_BUILD_SETUP**
**EXTERNAL_SOURCES**


```

使用国内镜像地址：

```
repositories {**ARTIFACTORYREPOSITORY**
    maven{ url 'http://maven.aliyun.com/nexus/content/repositories/central/'}
    google()
    jcenter()
}

```

参考文档：[(22条消息) 彻底解决Jenkins针对Unity2018.4以后的版本及2019+Gradle报错打不出包的问题_unity2018.4打包apk打不出来_铸梦xy的博客-CSDN博客](https://blog.csdn.net/qq_42461824/article/details/105301843)



## Redis

### 一、下载windows版本的Redis

去官网找了很久，发现原来在官网上可以下载的windows版本的，现在官网以及没有下载地址，只能在github上下载，官网只提供linux版本的下载

官网下载地址：http://redis.io/download

github下载地址：https://github.com/MSOpenTech/redis/tags

### 二、安装Redis

1.这里下载的是Redis-x64-3.2.100版本，我的电脑是win7 64位，所以下载64位版本的，在运行中输入cmd，然后把目录指向解压的Redis目录。

2、启动命令

redis-server redis.windows.conf，出现下图显示表示启动成功了。

### 三、设置Redis服务

1、由于上面虽然启动了redis，但是只要一关闭cmd窗口，redis就会消失。所以要把redis设置成windows下的服务。

也就是设置到这里，首先发现是没用这个Redis服务的。

2、设置服务命令

redis-server --service-install redis.windows-service.conf --loglevel verbose

输入命令之后没有报错，表示成功了，刷新服务，会看到多了一个redis服务。

3、常用的redis服务命令。

卸载服务：redis-server --service-uninstall

开启服务：redis-server --service-start

停止服务：redis-server --service-stop

### 特别注意：

​	使用服务方式启动时使用的配置：redis.windows-service.conf

​	直接启动时使用的配置：redis.windows.conf

参考文档：[windows下安装redis并设置自启动 - 开拓丿飞 - 博客园 (cnblogs.com)](https://www.cnblogs.com/feigao/p/11157607.html)
